(NZ=NZ||{}).BGColor={cream:["white","mintcream"],almond:["cornsilk","blanchedalmond"],lemon:["lemonchiffon","khaki"],spring:["mediumspringgreen","springgreen"],sky:["powderblue","skyblue"],salmon:["lightsalmon","orangered"],goldy:["yellow","gold"],grass:["mediumseagreen","seagreen"],sea:["deepskyblue","cornflowerblue"],orchid:["orchid","mediumorchid"],darkOrchid:["darkorchid","darkslateblue"],dark:["#1a1a1a","black"],keys:[],list:[]},NZ.BGColor.keys=Object.keys(NZ.BGColor),NZ.BGColor.keys.splice(NZ.BGColor.keys.length-2),NZ.BGColor.list=Object.values(NZ.BGColor),NZ.BGColor.list.splice(NZ.BGColor.list.length-2),(NZ=NZ||{}).BoundRect={ID:0,list:[],add(t){return t.id=this.ID++,this.list.push(t),t},remove(t){for(let e=this.list.length-1;e>=0;--e)if(this.list[e].id===t)return this.list.splice(e,1)[0]},create(t,e,i,s,n){return this.add(new NZ.BoundRect.rect(t,e,i,s,n))},hover:t=>t.containsPoint(NZ.Input.mousePosition),click(t){return NZ.Input.mouseDown(0)&&this.hover(t)}},NZ.BoundRect.rect=function(t,e,i,s,n){this.x=t||0,this.y=e||0,this.w=i||32,this.h=s||32,this.top=this.y,this.left=this.x,this.right=this.x+this.w,this.bottom=this.y+this.h,this.center=this.x+.5*this.w,this.middle=this.y+.5*this.h,this.update=(()=>{this.top=this.y,this.left=this.x,this.right=this.x+this.w,this.bottom=this.y+this.h,this.center=this.x+.5*this.w,this.middle=this.y+.5*this.h}),this.set=((t,e,i,s)=>{this.x=t||0,this.y=e||0,this.w=i||32,this.h=s||32,this.update()}),this.reset=(()=>{this.set()}),this.click=(()=>{for(let t=this.listeners.click.length-1;t>=0;--t)this.listeners.click[t]()}),this.listeners={click:[]},this.on=((t,e)=>(this.listeners[t].push(e),e)),this.off=((t,e)=>{const i=this.listeners[t];for(let t=i.length-1;t>=0;--t)if(i[t]===e)return i.splice(t,1)[0]}),this.containsPoint=((t,e)=>("object"==typeof t&&(e=t.y,t=t.x),void 0===e&&(e=t),t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom)),"function"==typeof n&&this.on("click",n)},(NZ=NZ||{}).C={aliceBlue:"#f0f8ff",antiqueWhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedAlmond:"#ffebcd",blue:"#0000ff",blueViolet:"#8a2be2",brown:"#a52a2a",burlyWood:"#deb887",cadetBlue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerBlue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkBlue:"#00008b",darkCyan:"#008b8b",darkGoldenRod:"#b8860b",darkGray:"#a9a9a9",darkGrey:"#a9a9a9",darkGreen:"#006400",darkKhaki:"#bdb76b",darkMagenta:"#8b008b",darkOliveGreen:"#556b2f",darkOrange:"#ff8c00",darkOrchid:"#9932cc",darkRed:"#8b0000",darkSalmon:"#e9967a",darkSeaGreen:"#8fbc8f",darkSlateBlue:"#483d8b",darkSlateGray:"#2f4f4f",darkSlateGrey:"#2f4f4f",darkTurquoise:"#00ced1",darkViolet:"#9400d3",deepPink:"#ff1493",deepSkyBlue:"#00bfff",dimGray:"#696969",dimGrey:"#696969",dodgerBlue:"#1e90ff",fireBrick:"#b22222",floralWhite:"#fffaf0",forestGreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostWhite:"#f8f8ff",gold:"#ffd700",goldenRod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenYellow:"#adff2f",honeyDew:"#f0fff0",hotPink:"#ff69b4",indianRed:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderBlush:"#fff0f5",lawnGreen:"#7cfc00",lemonChiffon:"#fffacd",lightBlue:"#add8e6",lightCoral:"#f08080",lightCyan:"#e0ffff",lightGoldenRodYellow:"#fafad2",lightGray:"#d3d3d3",lightGrey:"#d3d3d3",lightGreen:"#90ee90",lightPink:"#ffb6c1",lightSalmon:"#ffa07a",lightSeaGreen:"#20b2aa",lightSkyBlue:"#87cefa",lightSlateGray:"#778899",lightSlateGrey:"#778899",lightSteelBlue:"#b0c4de",lightYellow:"#ffffe0",lime:"#00ff00",limeGreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumAquaMarine:"#66cdaa",mediumBlue:"#0000cd",mediumOrchid:"#ba55d3",mediumPurple:"#9370db",mediumSeaGreen:"#3cb371",mediumSlateBlue:"#7b68ee",mediumSpringGreen:"#00fa9a",mediumTurquoise:"#48d1cc",mediumVioletRed:"#c71585",midnightBlue:"#191970",mintCream:"#f5fffa",mistyRose:"#ffe4e1",moccasin:"#ffe4b5",navajoWhite:"#ffdead",navy:"#000080",oldLace:"#fdf5e6",olive:"#808000",oliveDrab:"#6b8e23",orange:"#ffa500",orangeRed:"#ff4500",orchid:"#da70d6",paleGoldenRod:"#eee8aa",paleGreen:"#98fb98",paleTurquoise:"#afeeee",paleVioletRed:"#db7093",papayaWhip:"#ffefd5",peachPuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderBlue:"#b0e0e6",purple:"#800080",rebeccaPurple:"#663399",red:"#ff0000",rosyBrown:"#bc8f8f",royalBlue:"#4169e1",saddleBrown:"#8b4513",salmon:"#fa8072",sandyBrown:"#f4a460",seaGreen:"#2e8b57",seaShell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyBlue:"#87ceeb",slateBlue:"#6a5acd",slateGray:"#708090",slateGrey:"#708090",snow:"#fffafa",springGreen:"#00ff7f",steelBlue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whiteSmoke:"#f5f5f5",yellow:"#ffff00",yellowGreen:"#9acd32",none:"#0000",keys:[],list:[],random(){return this.list[Math.floor(Math.random()*this.list.length)]},makeRGB:(t,e,i)=>(void 0===e&&(e=t),void 0===i&&(i=t),`rgb(${t}, ${e}, ${i})`),makeRGBA(t,e,i,s){return 2===arguments.length&&(s=e,e=t),void 0===e&&(e=t),void 0===i&&(i=t),void 0===s&&(s=1),`rgba(${t}, ${e}, ${i}, ${s})`},componentToHEX(t){const e=Math.ceil(t).toString(16);return e.length<2?`0${e}`:e},RGBToRGBComponent:t=>({r:(t=t.replace("rgb(","").replace(")","").split(",").map(t=>+t))[0],g:t[1],b:t[2]}),HEXToRGBComponent:t=>((t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(t,e,i,s)=>e+e+i+i+s+s)))instanceof Array||(t=[0,0,0,0]),{r:parseInt(t[1],16)||0,g:parseInt(t[2],16)||0,b:parseInt(t[3],16)||0}),RGBComponentToRGB:(t,e=1)=>`rgb(${t.r*e}, ${t.g*e}, ${t.b*e})`,RGBComponentToHEX(t,e=1){return`#${this.componentToHEX(t.r*e)}${this.componentToHEX(t.g*e)}${this.componentToHEX(t.b*e)}`},RGBToHEX(t,e=1){return this.RGBComponentToHEX(this.RGBToRGBComponent(t),e)},HEXToRGB(t,e=1){return this.RGBComponentToRGB(this.HEXToRGBComponent(t),e)},multiply(t,e=1){if(t.includes("rgb"))return this.RGBComponentToRGB(this.RGBToRGBComponent(t),e);if(t.includes("#"))return this.RGBComponentToHEX(this.HEXToRGBComponent(t),e);throw new TypeError("The provided value 'c' must be in CSS rgb([r], [g], [b]) or hex #[r][g][b] format.")}},NZ.C.keys=Object.keys(NZ.C),NZ.C.keys.splice(NZ.C.keys.length-14),NZ.C.list=Object.values(NZ.C),NZ.C.list.splice(NZ.C.list.length-14),(NZ=NZ||{}).Canvas=document.createElement("canvas"),NZ.Canvas.id="NZCanvas",NZ.Canvas.ctx=NZ.Canvas.getContext("2d"),(NZ=NZ||{}).Cursor={alias:"alias",all:"all",allScroll:"all-scroll",auto:"auto",cell:"cell",colResize:"col-resize",contextMenu:"context-menu",copy:"copy",crosshair:"crosshair",default:"default",eResize:"e-resize",ewResize:"ew-resize",help:"help",inherit:"inherit",initial:"initial",move:"move",nResize:"n-resize",neResize:"ne-resize",neswResize:"nesw-resize",noDrop:"no-drop",none:"none",none:"none",notAllowed:"not-allowed",nsResize:"ns-resize",nwResize:"nw-resize",nwseResize:"nwse-resize",pointer:"pointer",progress:"progress",rowResize:"row-resize",sResize:"s-resize",seResize:"se-resize",swResize:"sw-resize",text:"text",unset:"unset",verticalText:"vertical-text",wResize:"w-resize",wait:"wait",zoomIn:"zoom-in",zoomOut:"zoom-out",list:[],image:(t,e=0,i=0)=>(t instanceof Image&&(t=t.src),`url(${t}) ${e} ${i}, auto`),random(){return this.list[Math.floor(Math.random()*this.list.length)]}},NZ.Cursor.list=Object.values(NZ.Cursor),NZ.Cursor.list.splice(NZ.Cursor.list.length-3),(NZ=NZ||{}).Debug={mode:0,modeAmount:3,modeKeyCode:85,modeText(){return`${this.mode}/${this.modeAmount-1}`}},(NZ=NZ||{}).Draw={_defaultCtx:null,_defaultFont:{size:16,style:"",family:"Maven Pro, sans-serif"},autoReset:!0,ctx:null,textHeight:10,images:{},sprites:{},strips:{},vertices:[],degtorad:t=>.017453292519943295*t,init(t={}){return t.ctx&&(this._defaultCtx=t.ctx),t.font&&(this._defaultFont=t.font),this.reset(),this},setCtx(t){this.ctx=t},resetCtx(){this.ctx=this._defaultCtx},onCtx(t,e){this.setCtx(t),e(),this.resetCtx()},createCanvas(t,e){const i=document.createElement("canvas");return i.width=t||300,i.height=e||150,i.ctx=i.getContext("2d"),i},createCanvasExt(t,e,i){const s=this.createCanvas(t,e);return this.onCtx(s.ctx,i),s},copyCanvas(t,e,i){return e=e||t.width,i=i||t.height,this.createCanvasExt(e,i,()=>{this.ctx.drawImage(t,0,0,e,i)})},setAlpha(t){this.ctx.globalAlpha=t},resetAlpha(){this.ctx.globalAlpha=1},setFill(t){this.ctx.fillStyle=t},setStroke(t){this.ctx.strokeStyle=t},setColor(t,e){void 0===e&&(e=t),this.ctx.fillStyle=t,this.ctx.strokeStyle=e},resetColor(){this.setColor("#000000")},setShadow(t,e,i=0,s="#000000"){this.ctx.shadowBlur=i,this.ctx.shadowColor=s,this.ctx.shadowOffsetX=t,this.ctx.shadowOffsetY=e},resetShadow(){this.setShadow(0,0)},setFont(t){this.ctx.font=`${t.style}${t.size}px ${t.family}, serif`,this.textHeight=t.size},resetFont(){this.setFont(this._defaultFont)},setHAlign(t){this.ctx.textAlign=t},setVAlign(t){this.ctx.textBaseline=t},setHVAlign(t,e){this.ctx.textAlign=t,this.ctx.textBaseline=e},resetHVAlign(){this.setHVAlign("left","top")},splitText:t=>(""+t).split("\n"),text(t,e,i){let s=0;const n=this.splitText(i);switch(this.ctx.textBaseline){case"bottom":s=-this.textHeight*(n.length-1);break;case"middle":s=-this.textHeight*(n.length-1)*.5}for(let i=n.length-1;i>=0;--i)this.ctx.fillText(n[i],t,e+s+this.textHeight*i)},getTextWidth(t){return Math.max(...this.splitText(t).map(t=>this.ctx.measureText(t).width))},getTextHeight(t){return this.textHeight*this.splitText(t).length},textRegular(t,e,i,s=!1){s?this.ctx.strokeText(i,t,e):this.ctx.fillText(i,t,e)},getTextWidthRegular(t){return this.ctx.measureText(t).width},addImage(t,e,i){return i.origin=t,this.images[e]=i,this.images[e]},addSprite(t,e,i){this.sprites[e]=[];for(const s of i)s.origin=t,this.sprites[e].push(s);return this.sprites[e]},addStrip(t,e,i,s){return i.strip=s,i.origin=t,this.strips[e]=i,this.strips[e]},imageEl(t,e,i,s={x:.5,y:.5}){e-=t.width*s.x,i-=t.height*s.y,this.ctx.drawImage(t,e,i)},image(t,e,i){const s=this.images[t];this.imageEl(s,e,i,s.origin)},sprite(t,e,i,s){const n=this.sprites[t][e];this.imageEl(n,i,s,n.origin)},strip(t,e,i,s){const n=this.strips[t],o={w:n.width/n.strip,h:n.height};i-=o.w*n.origin.x,s-=o.h*n.origin.y,this.ctx.drawImage(n,e%n.strip*o.w,0,o.w,o.h,i,s,o.w,o.h)},fill(){this.ctx.fill()},stroke(){this.ctx.stroke()},draw(t=!1){t?this.ctx.stroke():this.ctx.fill()},rect(t,e,i,s,n=!1){this.ctx.beginPath(),this.ctx.rect(t,e,i,s),this.draw(n)},circle(t,e,i,s=!1){this.ctx.beginPath(),this.ctx.arc(t,e,i,0,2*Math.PI),this.draw(s)},setLineCap(t){this.ctx.lineCap=t},resetLineCap(){this.ctx.lineCap=NZ.LineCap.butt},setLineJoin(t){this.ctx.lineJoin=t},resetLineJoin(){this.ctx.lineJoin=NZ.LineJoin.miter},setLineWidth(t){this.ctx.lineWidth=t},resetLineWidth(){this.ctx.lineWidth=1},setStrokeWeight(t){this.setLineWidth(t)},resetStrokeWeight(){this.resetLineWidth()},setLineDash(t,e=0){this.ctx.setLineDash(t),this.ctx.lineDashOffset=e},resetLineDash(){this.setLineDash(NZ.LineDash.solid)},arc(t,e,i,s,n,o=!1){n<0&&(s=n,n=0),this.ctx.beginPath(),this.ctx.arc(t,e,i,this.degtorad(s),this.degtorad(n)),this.draw(o)},line(t,e,i,s){this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,s),this.ctx.stroke()},plus(t,e,i){this.ctx.beginPath(),this.ctx.moveTo(t,e-i),this.ctx.lineTo(t,e+i),this.ctx.moveTo(t-i,e),this.ctx.lineTo(t+i,e),this.ctx.stroke()},triangle(t,e,i,s,n,o,r=!1){this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,s),this.ctx.lineTo(n,o),this.ctx.closePath(),this.draw(r)},roundRect(t,e,i,s,n=10,o=!1){i<0&&(t+=i,i=-i),s<0&&(e+=s,s=-s),n=Math.min(Math.min(.5*i,.5*s),Math.max(0,n))||0,this.ctx.beginPath(),this.ctx.moveTo(t,e+n),this.ctx.quadraticCurveTo(t,e,t+n,e),this.ctx.lineTo(t+i-n,e),this.ctx.quadraticCurveTo(t+i,e,t+i,e+n),this.ctx.lineTo(t+i,e+s-n),this.ctx.quadraticCurveTo(t+i,e+s,t+i-n,e+s),this.ctx.lineTo(t+n,e+s),this.ctx.quadraticCurveTo(t,e+s,t,e+s-n),this.ctx.closePath(),this.draw(o)},point(t,e,i=1){"object"==typeof t&&("number"==typeof e&&(i=e),e=t.y,t=t.x),this.circle(t,e,.5*i)},pointLine(t,e){this.line(t.x,t.y,e.x,e.y)},pointRect(t,e,i,s,n=!1){this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.lineTo(i.x,i.y),this.ctx.lineTo(s.x,s.y),this.ctx.closePath(),this.draw(n)},pointCircle(t,e,i=!1){this.circle(t.x,t.y,e,i)},pointTriangle(t,e,i,s=!1){this.triangle(t.x,t.y,e.x,e.y,i.x,i.y,s)},isoRect(t,e,i,s=!1){e*=.5,i*=.5,this.pointRect({x:t.x,y:t.y-i},{x:t.x+e,y:t.y},{x:t.x,y:t.y+i},{x:t.x-e,y:t.y},s)},gridRect(t,e,i,s,n=!1){this.rect(t*i,e*s,i,s,n)},boundRect(t,e=!1){this.rect(t.left,t.top,t.w,t.h,e)},primitiveBegin(){this.vertices.length=0},vertex(t,e){"object"==typeof t&&(e=t.y,t=t.x),void 0===e&&(e=t),this.vertices.push({x:t,y:e})},primitiveEnd(t=NZ.Primitive.Fill){this.primitiveType=t;const e=this.primitiveType.quantity,i=this.primitiveType.closePath,s=this.primitiveType.isStroke,n=this.vertices.length;1===e&&this.setLineCap("round"),this.ctx.beginPath();for(let t=0;t<n;t++){const n=this.vertices[t];1===e?(this.draw(s),this.ctx.beginPath(),this.ctx.moveTo(n.x,n.y),this.ctx.lineTo(n.x,n.y)):0===t||e>1&&t%e==0?(i&&this.ctx.closePath(),this.draw(s),this.ctx.beginPath(),this.ctx.moveTo(n.x,n.y)):this.ctx.lineTo(n.x,n.y)}i&&this.ctx.closePath(),this.draw(s),this.resetLineCap()},ellipseRotated(t,e,i,s,n,o=!1){this.ctx.beginPath(),this.ctx.ellipse(t,e,Math.abs(i),Math.abs(s),n,0,2*Math.PI),this.ctx.closePath(),this.draw(o)},ellipse(t,e,i,s,n=!1){this.ellipseRotated(t,e,i,s,0,n)},starExtRotated(t,e,i,s,n,o,r=!1){this.ctx.beginPath();for(let r=0;r<=2*i;r++){const a=r%2==0?s:n,h=Math.PI*r/i-this.degtorad(o),c={x:t+a*Math.sin(h),y:e+a*Math.cos(h)};0===r?this.ctx.moveTo(c.x,c.y):this.ctx.lineTo(c.x,c.y)}this.ctx.closePath(),this.draw(r)},starRotated(t,e,i,s,n=!1){this.starExtRotated(t,e,5,.5*i,i,s,n)},starExt(t,e,i,s,n,o=!1){this.starExtRotated(t,e,i,s,n,0,o)},star(t,e,i,s=!1){this.starRotated(t,e,i,0,s)},onTransform(t,e,i,s,n,o){this.ctx.save(),this.ctx.translate(t,e),this.ctx.rotate(this.degtorad(n)),this.ctx.scale(i,s),o(),this.ctx.restore()},textTransformed(t,e,i,s,n,o){this.onTransform(t,e,s,n,o,()=>this.text(0,0,i))},rectTransformed(t,e,i,s,n,o,r,a,h={x:.5,y:.5}){this.onTransform(t,e,o,r,a,()=>this.rect(-i*h.x,-s*h.y,i,s,n))},starTransformed(t,e,i,s,n,o,r){this.onTransform(t,e,n,o,r,()=>this.star(0,0,i,s))},starExtTransformed(t,e,i,s,n,o,r,a,h){this.onTransform(t,e,r,a,h,()=>this.starExt(0,0,i,s,n,o))},roundRectTransformed(t,e,i,s,n,o,r,a,h,c={x:.5,y:.5}){this.onTransform(t,e,r,a,h,()=>this.roundRect(-i*c.x,-s*c.y,i,s,n,o))},textRotated(t,e,i,s){this.textTransformed(t,e,i,1,1,s)},rectRotated(t,e,i,s,n,o=!1,r={x:.5,y:.5}){this.rectTransformed(t,e,i,s,o,1,1,n,r)},roundRectRotated(t,e,i,s,n,o,r=!1,a={x:.5,y:.5}){this.roundRectTransformed(t,e,i,s,n,r,1,1,o,a)},imageTransformed(t,e,i,s,n,o){this.onTransform(e,i,s,n,o,()=>this.image(t,0,0))},imageRotated(t,e,i,s){this.imageTransformed(t,e,i,1,1,s)},imageExt(t,e,i,s,n,o,r){this.setAlpha(r),this.imageTransformed(t,e,i,s,n,o),this.resetAlpha()},spriteTransformed(t,e,i,s,n,o,r){this.onTransform(i,s,n,o,r,()=>this.sprite(t,e,0,0))},spriteRotated(t,e,i,s,n){this.spriteTransformed(t,e,i,s,1,1,n)},spriteExt(t,e,i,s,n,o,r,a){this.setAlpha(a),this.spriteTransformed(t,e,i,s,n,o,r),this.resetAlpha()},stripTransformed(t,e,i,s,n,o,r){this.onTransform(i,s,n,o,r,()=>this.strip(t,e,0,0))},stripRotated(t,e,i,s,n){this.stripTransformed(t,e,i,s,1,1,n)},stripExt(t,e,i,s,n,o,r,a){this.setAlpha(a),this.stripTransformed(t,e,i,s,n,o,r),this.resetAlpha()},reset(){this.resetCtx(),this.resetFont(),this.resetAlpha(),this.resetColor(),this.resetShadow(),this.resetHVAlign(),this.resetLineCap(),this.resetLineJoin(),this.resetLineWidth(),this.resetLineDash()},textBackground(t,e,i,s={}){s.gap=s.gap||5,s.origin=s.origin||{x:0,y:0},s.bgColor=s.bgColor||"#000000",s.isStroke=s.isStroke||!1,s.textColor=s.textColor||"#ffffff";const n=this.getTextWidth(i)+2*s.gap,o=this.getTextHeight(i)+2*s.gap;t-=n*s.origin.x,e-=o*s.origin.y,this.setColor(s.bgColor),this.rect(t,e,n,o,s.isStroke),this.setFill(s.textColor),this.setHVAlign("center","middle"),this.text(t+.5*n,e+.5*o,i)},textBG(t,e,i,s={}){this.textBackground(t,e,i,s)},heart(t,e,i,s,n=!1){i*=.5,s*=.5,this.ctx.beginPath(),this.ctx.moveTo(t,e-.5*s),this.ctx.quadraticCurveTo(t+i,e-s,t+i,e),this.ctx.lineTo(t,e+s),this.ctx.lineTo(t-i,e),this.ctx.quadraticCurveTo(t-i,e-s,t,e-.5*s),this.draw(n)},pointArrow(t,e,i,s){i=Math.max(1,i||.2*Math.hypot(e.x-t.x,e.y-t.y));let n=Math.atan2(e.y-t.y,e.x-t.x),o=s?45:135,r=Math.cos(n-this.degtorad(o))*i,a=Math.sin(n-this.degtorad(o))*i,h=Math.cos(n+this.degtorad(o))*i,c=Math.sin(n+this.degtorad(o))*i;this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.moveTo(e.x+r,e.y+a),this.ctx.lineTo(e.x,e.y),this.ctx.lineTo(e.x+h,e.y+c),this.ctx.stroke()},boundRectButton(t,e,i="black",s="white"){let n=NZ.BoundRect.hover(t);this.setFill(n?s:i),this.boundRect(t),this.setFill(n?i:s),this.setHVAlign("center","middle"),this.text(t.center,t.middle,e)}},(NZ=NZ||{}).Align={l:"left",r:"right",c:"center",t:"top",b:"bottom",m:"middle"},NZ.LineCap={butt:"butt",round:"round"},NZ.LineJoin={miter:"miter",round:"round",bevel:"bevel"},NZ.LineDash={solid:[],dot:[3,10],short:[10,10],long:[30,20]},NZ.Primitive={Fill:{name:"Fill",quantity:0,closePath:!0,isStroke:!1},Line:{name:"Line",quantity:0,closePath:!1,isStroke:!0},Stroke:{name:"Stroke",quantity:0,closePath:!0,isStroke:!0},LineList:{name:"Line List",quantity:2,closePath:!1,isStroke:!0},PointList:{name:"Point List",quantity:1,closePath:!1,isStroke:!0},TriangleList:{name:"Triangle List",quantity:3,closePath:!0,isStroke:!0},TriangleListFill:{name:"Triangle List Fill",quantity:3,closePath:!1,isStroke:!1}},(NZ=NZ||{}).Font={h1:48,h2:36,h3:24,h4:16,h5:14,h6:10,regular:"",bold:"bold ",italic:"italic ",boldItalic:"bold italic ",familyDefault:"Maven Pro, sans-serif",generate:(t,e="",i=NZ.Font.familyDefault)=>({size:t,style:e,family:i}),createGoogleFontLink(t){const e=document.createElement("link");return e.href=`https://fonts.googleapis.com/css2?family=${t.split(" ").join("+")}&display=swap`,e.rel="stylesheet",e},embedGoogleFonts(...t){for(const e of t)document.head.appendChild(this.createGoogleFontLink(e))},setFamily(t){const e=Object.keys(NZ.Font);for(const i of e){const e=NZ.Font[i];"object"==typeof e&&void 0!==e.size&&void 0!==e.style&&void 0!==e.family&&(NZ.Font[i].family=t)}}},NZ.Font.xxl=NZ.Font.generate(NZ.Font.h1),NZ.Font.xl=NZ.Font.generate(NZ.Font.h2),NZ.Font.l=NZ.Font.generate(NZ.Font.h3),NZ.Font.m=NZ.Font.generate(NZ.Font.h4),NZ.Font.sm=NZ.Font.generate(NZ.Font.h5),NZ.Font.s=NZ.Font.generate(NZ.Font.h6),NZ.Font.xxlb=NZ.Font.generate(NZ.Font.xxl.size,NZ.Font.bold,NZ.Font.xxl.family),NZ.Font.xlb=NZ.Font.generate(NZ.Font.xl.size,NZ.Font.bold,NZ.Font.xl.family),NZ.Font.lb=NZ.Font.generate(NZ.Font.l.size,NZ.Font.bold,NZ.Font.l.family),NZ.Font.mb=NZ.Font.generate(NZ.Font.m.size,NZ.Font.bold,NZ.Font.m.family),NZ.Font.smb=NZ.Font.generate(NZ.Font.sm.size,NZ.Font.bold,NZ.Font.sm.family),NZ.Font.sb=NZ.Font.generate(NZ.Font.s.size,NZ.Font.bold,NZ.Font.s.family),(NZ=NZ||{}).Input={targetElement:null,preventedKeys:[38,40,32],keys:[],mice:[],touches:[],activeTouches:[],position:{x:0,y:0},mousePosition:{x:0,y:0},mouseMovement:{x:0,y:0},mouseX:0,mouseY:0,movementX:0,movementY:0,mouseMove:!1,mouseWheelDelta:0,get touchCount(){return this.activeTouches.length},setTargetElement(t){this.targetElement=t},init(){this.keys.length=0,this.mice.length=0,this.mousePosition.x=0,this.mousePosition.y=0;for(let t=0;t<256;t++)this.keys.push(this.create());for(let t=0;t<3;t++)this.mice.push(this.create());for(let t=0;t<3;t++){const t=this.create();t.position={x:0,y:0},t.setPosition=((t,e)=>{this.position.x=t,this.position.y=e}),this.touches.push(t)}},reset(){for(let t=this.keys.length-1;t>=0;--t)this.keys[t].reset();for(let t=this.mice.length-1;t>=0;--t)this.mice[t].reset();for(let t=this.touches.length-1;t>=0;--t)this.touches[t].reset();this.movementX=this.mouseMovement.x=0,this.movementY=this.mouseMovement.y=0,this.mouseMove=!1,this.mouseWheelDelta=0,this.activeTouches.length=0},create:()=>({held:!1,pressed:!1,released:!1,repeated:!1,up(){this.held=!1,this.released=!0},down(){this.held||(this.held=!0,this.pressed=!0),this.repeated=!0},reset(){this.pressed=!1,this.released=!1,this.repeated=!1}}),keyUp(t){return this.keys[t].released},keyDown(t){return this.keys[t].pressed},keyHold(t){return this.keys[t].held},keyRepeat(t){return this.keys[t].repeated},keyUpAny(){for(let t=this.keys.length-1;t>=0;--t)if(this.keys[t].released)return!0;return!1},keyDownAny(){for(let t=this.keys.length-1;t>=0;--t)if(this.keys[t].pressed)return!0;return!1},keyHoldAny(){for(let t=this.keys.length-1;t>=0;--t)if(this.keys[t].held)return!0;return!1},keyUpNone(){return!this.keyUpAny()},keyDownNone(){return!this.keyDownAny()},keyHoldNone(){return!this.keyHoldAny()},mouseUp(t){return this.mice[t].released},mouseDown(t){return this.mice[t].pressed},mouseHold(t){return this.mice[t].held},mouseRepeat(t){return this.mice[t].repeated},mouseWheelUp(){return this.mouseWheelDelta>0},mouseWheelDown(){return this.mouseWheelDelta<0},mouseUpAny(){for(let t=this.mice.length-1;t>=0;--t)if(this.mice[t].released)return!0;return!1},mouseDownAny(){for(let t=this.mice.length-1;t>=0;--t)if(this.mice[t].pressed)return!0;return!1},mouseHoldAny(){for(let t=this.mice.length-1;t>=0;--t)if(this.mice[t].held)return!0;return!1},mouseUpNone(){return!this.mouseUpAny()},mouseDownNone(){return!this.mouseDownAny()},mouseHoldNone(){return!this.mouseHoldAny()},touchUp(t){return this.touches[t].released},touchDown(t){return this.touches[t].pressed},touchHold(t){return this.touches[t].held},keyUpEvent(t){NZ.Input.keys[t.keyCode].up()},keyDownEvent(t){NZ.Input.preventedKeys.includes(t.keyCode)&&t.preventDefault(),NZ.Input.keys[t.keyCode].down()},setPosition(t,e){this.position.x=t,this.position.y=e},setMousePosition(t,e){"object"==typeof t&&(e=t.y,t=t.x),void 0===e&&(e=t),NZ.Input.mouseX=NZ.Input.mousePosition.x=t,NZ.Input.mouseY=NZ.Input.mousePosition.y=e,NZ.Input.setPosition(NZ.Input.mouseX,NZ.Input.mouseY)},getBoundingClientRect(t){let e=NZ.Input.targetElement||t;return e=e.getBoundingClientRect?e.getBoundingClientRect():{x:0,y:0}},updateMouse(t){const e=NZ.Input.getBoundingClientRect(t.srcElement);NZ.Input.setMousePosition(t.clientX-e.x,t.clientY-e.y),NZ.Input.movementX=NZ.Input.mouseMovement.x=t.movementX,NZ.Input.movementY=NZ.Input.mouseMovement.y=t.movementY},mouseUpEvent(t){NZ.Input.mice[t.button].up(),NZ.Input.updateMouse(t)},mouseDownEvent(t){NZ.Input.mice[t.button].down(),NZ.Input.updateMouse(t)},mouseMoveEvent(t){NZ.Input.updateMouse(t),NZ.Input.mouseMove=!0},mouseWheelEvent(t){NZ.Input.mouseWheelDelta=t.wheelDelta},convertTouch(t){const e=this.getBoundingClientRect(t.target);return{id:t.identifier,x:t.clientX-e.x,y:t.clientY-e.y}},updateTouches(t){this.activeTouches.length=0;for(const e of t.changedTouches)this.activeTouches.push(this.convertTouch(e))},touchEndEvent(t){for(const e of t.changedTouches){const t=NZ.Input.convertTouch(e);NZ.Input.touches[t.id].up(),NZ.Input.touches[t.id].setPosition(t.x,t.y)}NZ.Input.updateTouches(t)},touchMoveEvent(t){for(const e of t.changedTouches){const t=NZ.Input.convertTouch(e);NZ.Input.touches[t.id].setPosition(t.x,t.y)}NZ.Input.updateTouches(t)},touchStartEvent(t){for(const e of t.changedTouches){const t=NZ.Input.convertTouch(e);NZ.Input.touches[t.id].held||(NZ.Input.touches[t.id].down(),NZ.Input.touches[t.id].setPosition(t.x,t.y))}NZ.Input.updateTouches(t)},setupEventAt(t){(t=t||window).addEventListener("keyup",this.keyUpEvent),t.addEventListener("keydown",this.keyDownEvent),t.addEventListener("mouseup",this.mouseUpEvent),t.addEventListener("mousedown",this.mouseDownEvent),t.addEventListener("mousemove",this.mouseMoveEvent),t.addEventListener("mousewheel",this.mouseWheelEvent),t.addEventListener("touchend",this.touchEndEvent),t.addEventListener("touchmove",this.touchMoveEvent),t.addEventListener("touchstart",this.touchStartEvent)},testMoving4Dir(t,e=5){t.x+=(this.keyHold(39)-this.keyHold(37))*e,t.y+=(this.keyHold(40)-this.keyHold(38))*e},testMoving4DirWASD(t,e=5){t.x+=(this.keyHold(68)-this.keyHold(65))*e,t.y+=(this.keyHold(83)-this.keyHold(87))*e},testLogMouseOnClick(){this.mouseDown(0)&&console.log(`${this.mouseX}, ${this.mouseY}`)}},NZ.Input.init(),(NZ=NZ||{}).KeyCode={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,Break:19,CapsLock:20,Escape:27,PageUp:33,Space:32,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Print:44,Insert:45,Delete:46,Alpha0:48,Alpha1:49,Alpha2:50,Alpha3:51,Alpha4:52,Alpha5:53,Alpha6:54,Alpha7:55,Alpha8:56,Alpha9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftWindow:91,RightWindow:92,Select:93,Keypad0:96,Keypad1:97,Keypad2:98,Keypad3:99,Keypad4:100,Keypad5:101,Keypad6:102,Keypad7:103,Keypad8:104,Keypad9:105,KeypadMultiply:106,KeypadPlus:107,KeypadMinus:109,KeypadPeriod:110,KeypadDivide:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Numlock:144,ScrollLock:145,Semicolon:186,Equals:187,Comma:188,Minus:189,Period:190,Slash:191,LeftBracket:219,Backslash:220,RightBracket:221,Quote:222},(NZ=NZ||{}).Loader={loaded:!1,loadAmount:0,loadedCount:0,get loadProgress(){return this.loadAmount<1?1:this.loadedCount/this.loadAmount},setOnLoadEvent(t){this.loadAmount++,_this=this,t.onload=(()=>{_this.loadedCount++})},loadImage(t,e,i){const s=new Image;s.src=i,NZ.Draw.addImage(t,e,s),this.setOnLoadEvent(s)},loadSprite(t,e,i){const s=[];for(const t of i){const e=new Image;e.src=t,s.push(e),this.setOnLoadEvent(e)}NZ.Draw.addSprite(t,e,s)},loadStrip(t,e,i,s){const n=new Image;n.src=i,NZ.Draw.addStrip(t,e,n,s),this.setOnLoadEvent(n)},loadSound(t,...e){const i=[];for(const t of e){const e=t.split(".").pop();if(NZ.Sound.supportedExt.includes(e)){const s="mp3"===e?"mpeg":e;i.push(`<source src="${t}" type="audio/${s}">`)}else console.warn(`Sound file extension not supported: .${e}`)}if(i.length>0){const e=new Audio;e.innerHTML=i.join(""),NZ.Sound.add(t,e)}}},(NZ=NZ||{}).start=((t={})=>{if(t.inputParent=t.inputParent||window,t.parent=t.parent||document.body,t.canvas=t.canvas||NZ.Canvas,t.canvas.id="NZCanvas",void 0!==t.inputParent.tabIndex&&(t.inputParent.tabIndex=t.inputParent.tabIndex),NZ.Input.setupEventAt(t.inputParent),NZ.Input.setTargetElement(t.canvas),NZ.Draw.init({ctx:t.canvas.getContext("2d"),font:t.defaultFont}),NZ.Stage.setupCanvas(t.canvas),"number"==typeof t.w&&"number"==typeof t.h){if(t.canvas.style.width=`${t.w}px`,t.canvas.style.height=`${t.h}px`,NZ.Stage.resize(t.w,t.h),t.stylePreset){const e=document.createElement("style");let i=t.stylePreset;"function"==typeof i&&(i=i(t.canvas.id)),e.innerHTML=i,document.head.appendChild(e)}}else{const e=document.createElement("style"),i=t.parent.id?`#${t.parent.id}`:t.parent.localName;e.innerHTML=NZ.StylePreset.fullViewport(t.canvas.id,i),document.head.appendChild(e)}if(t.preventContextMenu&&t.canvas.addEventListener("contextmenu",t=>t.preventDefault()),NZ.Stage.setBGColor(t.bgColor),"boolean"==typeof t.uiAutoReset&&(NZ.UI.autoReset=t.uiAutoReset),"boolean"==typeof t.drawAutoReset&&(NZ.Draw.autoReset=t.drawAutoReset),"boolean"==typeof t.stageAutoClear&&(NZ.Stage.autoClear=t.stageAutoClear),"boolean"==typeof t.stageRedrawOnResize&&(NZ.Stage.redrawOnResize=t.stageRedrawOnResize),t.debugModeAmount&&(NZ.Debug.modeAmount=t.debugModeAmount),t.debugModeKeyCode&&(NZ.Debug.modeKeyCode=t.debugModeKeyCode),t.parent.appendChild(t.canvas),NZ.Stage.resizeEvent(),!1!==t.stageAutoResize&&NZ.Stage.setupEvent(),NZ.Scene.on("restart",NZ.OBJ.onSceneRestart),!0===t.enablePersistent&&NZ.OBJ.enablePersistent(),t.embedGoogleFonts){let e=[];t.embedGoogleFonts instanceof Array&&(e=t.embedGoogleFonts),"string"==typeof t.embedGoogleFonts&&e.push(t.embedGoogleFonts),NZ.Font.embedGoogleFonts(...e)}if(t.favicon){const e=document.createElement("link");e.rel="icon",e.href=t.favicon,document.head.appendChild(e)}NZ.Scene.restart(),NZ.Runner.start()}),(NZ=NZ||{}).Mat4=function(){this.m=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]},NZ.Mat4.degtorad=function(t){return.017453292519943295*t},NZ.Mat4.mulVec3=function(t,e){let i=NZ.Vec3.zero;return i.x=e.x*t.m[0][0]+e.y*t.m[1][0]+e.z*t.m[2][0]+e.w*t.m[3][0],i.y=e.x*t.m[0][1]+e.y*t.m[1][1]+e.z*t.m[2][1]+e.w*t.m[3][1],i.z=e.x*t.m[0][2]+e.y*t.m[1][2]+e.z*t.m[2][2]+e.w*t.m[3][2],i.w=e.x*t.m[0][3]+e.y*t.m[1][3]+e.z*t.m[2][3]+e.w*t.m[3][3],i},NZ.Mat4.multVec3=function(t,e){return NZ.Mat4.mulVec3(t,e)},NZ.Mat4.mulMat4=function(t,e){const i=new NZ.Mat4;for(let s=0;s<4;s++)for(let n=0;n<4;n++)i.m[n][s]=t.m[n][0]*e.m[0][s]+t.m[n][1]*e.m[1][s]+t.m[n][2]*e.m[2][s]+t.m[n][3]*e.m[3][s];return i},NZ.Mat4.multMat4=function(t,e){return NZ.Mat4.mulMat4(t,e)},NZ.Mat4.makeIdentity=function(){const t=new NZ.Mat4;return t.m[0][0]=1,t.m[1][1]=1,t.m[2][2]=1,t.m[3][3]=1,t},NZ.Mat4.makeProjection=function(t=.5625,e=90,i=.1,s=1e3){const n=1/Math.tan(NZ.Mat4.degtorad(.5*e)),o=new NZ.Mat4;return o.m[0][0]=t*n,o.m[1][1]=n,o.m[2][2]=s/(s-i),o.m[3][2]=-s*i/(s-i),o.m[2][3]=1,o},NZ.Mat4.makeRotationX=function(t,e=new NZ.Mat4){return t=NZ.Mat4.degtorad(t),e.m[0][0]=1,e.m[1][1]=Math.cos(t),e.m[1][2]=Math.sin(t),e.m[2][1]=-Math.sin(t),e.m[2][2]=Math.cos(t),e.m[3][3]=1,e},NZ.Mat4.makeRotationY=function(t,e=new NZ.Mat4){return t=NZ.Mat4.degtorad(t),e.m[0][0]=Math.cos(t),e.m[0][2]=-Math.sin(t),e.m[1][1]=1,e.m[2][0]=Math.sin(t),e.m[2][2]=Math.cos(t),e.m[3][3]=1,e},NZ.Mat4.makeRotationZ=function(t,e=new NZ.Mat4){return t=NZ.Mat4.degtorad(t),e.m[0][0]=Math.cos(t),e.m[0][1]=Math.sin(t),e.m[1][0]=-Math.sin(t),e.m[1][1]=Math.cos(t),e.m[2][2]=1,e.m[3][3]=1,e},NZ.Mat4.makeTranslation=function(t,e,i){"object"==typeof t&&(i=t.z,e=t.y,t=t.x);const s=new NZ.Mat4;return s.m[0][0]=1,s.m[1][1]=1,s.m[2][2]=1,s.m[3][3]=1,s.m[3][0]=t,s.m[3][1]=e,s.m[3][2]=i,s},NZ.Mat4.makeScale=function(t,e,i){"object"==typeof t&&(i=t.z,e=t.y,t=t.x),void 0===i&&(i=t),void 0===e&&(e=t);const s=new NZ.Mat4;return s.m[0][0]=t,s.m[1][1]=e,s.m[2][2]=i,s.m[3][3]=1,s},NZ.Mat4.prototype.mult=function(t){return this.m=NZ.Mat4.multMat4(this,t).m,this},NZ.Mat4.makeTransformation=function(t){const e=Mat4.makeScale(t.scale),i={};i.X=Mat4.makeRotationX(t.rotation.x),i.Y=Mat4.makeRotationY(t.rotation.y),i.Z=Mat4.makeRotationZ(t.rotation.z);const s=t.rotationMode,n=Mat4.makeTranslation(t.position),o=e;return o.mult(i[s[2]]).mult(i[s[1]]).mult(i[s[0]]).mult(n),o},(NZ=NZ||{}).Mathz={},NZ.Mathz.PI2=2*Math.PI,NZ.Mathz.DEG_TO_RAD=Math.PI/180,NZ.Mathz.RAD_TO_DEG=180/Math.PI,NZ.Mathz.EPSILON=1e-6,NZ.Mathz.ONE_THIRD=1/3,NZ.Mathz.ONE_SIXTH=1/6,NZ.Mathz.TWO_THIRDS=2/3,NZ.Mathz.degtorad=(t=>t*NZ.Mathz.DEG_TO_RAD),NZ.Mathz.radtodeg=(t=>t*NZ.Mathz.RAD_TO_DEG),NZ.Mathz.map=((t,e,i,s,n,o,r)=>(t=s+(t-e)/(i-e)*(n-s),"number"==typeof o&&(t=Math.max(t,o)),"number"==typeof r&&(t=Math.min(t,r)),t)),NZ.Mathz.hypot=((t,e)=>Math.sqrt(t*t+e*e)),NZ.Mathz.hypotsq=((t,e)=>t*t+e*e),NZ.Mathz.clamp=((t,e,i)=>Math.min(Math.max(t,Math.min(e,i)),Math.max(e,i))),NZ.Mathz.range=((t,e=0,i=Math.random())=>t+i*(e-t)),NZ.Mathz.irange=((t,e=0)=>Math.floor(t+Math.random()*(e-t))),NZ.Mathz.choose=((...t)=>t[Math.floor(Math.random()*t.length)]),NZ.Mathz.randneg=((t=.5)=>Math.random()<t?-1:1),NZ.Mathz.randbool=((t=.5)=>Math.random()<t),NZ.Mathz.normalizeAngle=(t=>((t%=360)>180&&(t-=360),t<-180&&(t+=360),t)),NZ.Mathz.fuzzyEqual=((t,e,i=NZ.Mathz.EPSILON)=>Math.abs(e-t)<=i),NZ.Mathz.smoothRotate=((t,e,i=5)=>t+Math.sin(NZ.Mathz.degtorad(e-t))*i),(NZ=NZ||{}).Mesh=function(t=[]){this.tris=t},NZ.Mesh.prototype.onAllTris=function(t){const e=this.tris.length;for(let i=0;i<e;i++)t(this.tris[i],i)},NZ.Mesh.prototype.loadFromOBJText=function(t){this.tris.length=0;const e=[],i=t.split(/\s/),s=()=>+i.shift();for(;i.length>0;)switch(i.shift()){case"v":e.push(new NZ.Vec3(s(),s(),s()));break;case"f":this.tris.push(new NZ.Tri([e[s()-1],e[s()-1],e[s()-1]]))}},NZ.Mesh.applyTransform=function(t,e){const i=NZ.Mat4.makeTransformation(e),s=[];for(const e of t.tris)for(const t of e.p)s.includes(t)||(t.set(NZ.Mat4.multVec3(i,t)),s.push(t))},NZ.Mesh.LoadFromOBJText=function(t){const e=new NZ.Mesh;return e.loadFromOBJText(t),e},NZ.Mesh.makeCube=function(){return NZ.Mesh.LoadFromOBJText("v -1 1 1 v -1 -1 1 v -1 1 -1 v -1 -1 -1 v 1 1 1 v 1 -1 1 v 1 1 -1 v 1 -1 -1 f 5 3 1 f 3 8 4 f 7 6 8 f 2 8 6 f 1 4 2 f 5 2 6 f 5 7 3 f 3 7 8 f 7 5 6 f 2 4 8 f 1 3 4 f 5 1 2")},NZ.Mesh.readMaterial=function(t){const e={},i=t.split(/\s/);let s="";const n=()=>s=i.shift();for(;i.length;)switch(i.shift()){case"newmtl":e[n()]=[];break;case"Kd":e[s].push(+n(),+n(),+n())}return e},NZ.Mesh.LoadOBJ=function(t={}){const e=new NZ.Mesh;let i="";const s=NZ.Mesh.readMaterial(t.mtl),n=[],o=t.obj.split(/\s/),r=()=>+o.shift();for(;o.length>0;)switch(o.shift()){case"v":n.push(new NZ.Vec3(r(),r(),r()));break;case"usemtl":i=o.shift();break;case"f":{const t=[n[r()-1],n[r()-1],n[r()-1]],o=`rgb(${~~(255*s[i][0])}, ${~~(255*s[i][1])}, ${~~(255*s[i][2])})`;e.tris.push(new NZ.Tri(t,o));break}}return e};class NZNetBuffers{constructor(t=10){this.b=[],this.length=t;for(let t=0;t<this.length;t++)this.b.push([])}get(t){return this.b[t]}push(t,e){this.b[t].push(e)}pop(t){return this.b[t].shift()}clear(t){this.b[t].length=0}copy(t,e){const i=this.b[t],s=e;i.length=0;for(let t=s.length-1;t>=0;--t)i.unshift(s[t]);return i}}(NZ=NZ||{}).Net={DUMMY:0,parentPath:"NZ/",fbDatabase:null,connections:{},init(t){firebase.initializeApp(t),this.fbDatabase=firebase.database()},onValueEvent(t,e){const i=e.key,s=e.val();if(e.exists()){const n=+i;if("number"==typeof s.length)NZ.Net.copyBuffer(t,n,s);else{const i=[];e.forEach(t=>{i.push(t.val())}),NZ.Net.copyBuffer(t,n,i)}}},startListening(t,e){return this.fbDatabase.ref(t).on("value",e)},stopListening(t,e){this.fbDatabase.ref(t).off("value",e)},connectionExists(t){return void 0!==this.connections[t]},createConnection(t,e=10){if(this.connectionExists(t))return!1;const i=`${this.parentPath}${t}`;this.connections[t]={},this.connections[t].buffers=new NZNetBuffers(e),this.connections[t].listeners=[];for(let e=0;e<this.connections[t].buffers.length;e++)this.connections[t].listeners.push(this.startListening(`${i}/${e}`,e=>{this.onValueEvent(t,e)}));return!0},destroyConnection(t){if(!this.connectionExists(t))return!1;const e=`${this.parentPath}${t}`;for(let i=this.connections[t].listeners.length-1;i>=0;--i){const s=this.connections[t].listeners[i];this.stopListening(`${e}/${i}`,s)}return delete this.connections[t],!0},copyBuffer(t,e,i){this.connections[t].buffers.copy(e,i)},clearBuffer(t,e){const i=this.connections[t].buffers.get(e).slice();return this.connections[t].buffers.clear(e),i},push(t,e,i){this.connections[t].buffers.push(e,i)},getBuffer(t,e){return this.connections[t].buffers.get(e)},sendBuffer(t,e){const i=`${this.parentPath}${t}/${e}`;this.fbDatabase.ref(i).set(this.clearBuffer(t,e))},pushBuffer(t,e){const i=`${this.parentPath}${t}/${e}`;this.fbDatabase.ref(i).push(this.clearBuffer(t,e))},pop(t,e){return this.connections[t].buffers.pop(e)},sendUnsafe(t,e,...i){this.clearBuffer(t,e);for(const s of i)this.push(t,e,s);this.sendBuffer(t,e)},readUnsafe(t,e,i){const s=()=>this.pop(t,e);for(;this.getBuffer(t,e).length>0;)i(s)},send(t,e,...i){return!!this.connectionExists(t)&&(this.sendUnsafe(t,e,...i),this.clearBuffer(t,e),!0)},read(t,e,i){return!!this.connectionExists(t)&&(this.readUnsafe(t,e,s=>{i(s),this.clearBuffer(t,e)}),!0)},pushRoutine(t,e,...i){this.clearBuffer(t,e);for(const s of i)this.push(t,e,s);this.pushBuffer(t,e)},sendEmptyBuffers(t){for(let e=0;e<this.connections[t].buffers.length;e++)this.clearBuffer(t,e),this.sendBuffer(t,e)}};class NZObject{constructor(){this.x=0,this.y=0,this.id=0,this.nzDepth=0,this.nzActive=!0,this.nzVisible=!0,this.nzPersistent=!1}start(){}preUpdate(){}update(){}postUpdate(){}render(){}}NZ.OBJ={ID:0,list:[],names:[],marks:{},linkedClass:{},_currentMark:null,_updateDisabled:!1,_renderDisabled:!1,_persistentDisabled:!0,mark(t){this._currentMark=t},endMark(){this._currentMark=null},add(t){this.list.push([]),this.names.push(t),null!==this._currentMark&&(void 0===this.marks[this._currentMark]&&(this.marks[this._currentMark]=[]),this.marks[this._currentMark].push(t))},link(t,e){this.linkedClass[t]=e},addLink(t,e){this.add(t),this.link(t,e)},updateAll(){for(let t=this.list.length-1;t>=0;--t)for(let e=this.list[t].length-1;e>=0;--e)this.list[t][e].nzActive&&(this.list[t][e].preUpdate(),this.list[t][e]&&this.list[t][e].update(),this.list[t][e]&&this.list[t][e].postUpdate())},renderAll(){const t=[];for(let e=this.list.length-1;e>=0;--e)for(let i=this.list[e].length-1;i>=0;--i)this.list[e][i].nzVisible&&t.push(this.list[e][i]);t.sort((t,e)=>t.nzDepth<e.nzDepth?-1:1);for(let e=t.length-1;e>=0;--e)t[e].render()},update(){this._updateDisabled||this.updateAll()},render(){this._renderDisabled||this.renderAll()},updateFrom(t){const e=this.getIndex(t);for(let t=this.list[e].length-1;t>=0;--t)this.list[e][t].nzActive&&(this.list[e][t].preUpdate(),this.list[e][t]&&this.list[e][t].update(),this.list[e][t]&&this.list[e][t].postUpdate())},renderFrom(t){const e=[],i=this.getIndex(t);for(let t=this.list[i].length-1;t>=0;--t)this.list[i][t].nzVisible&&e.push(this.list[i][t]);e.sort((t,e)=>t.nzDepth<e.nzDepth?-1:1);for(let t=e.length-1;t>=0;--t)e[t].render()},enableUpdate(){this._updateDisabled=!1},disableUpdate(){this._updateDisabled=!0},enableRender(){this._renderDisabled=!1},disableRender(){this._renderDisabled=!0},enablePersistent(){this._persistentDisabled=!1},disablePersistent(){this._persistentDisabled=!0},getIndex(t){return"number"==typeof t?t:this.names.indexOf(t)},takeFrom(t){return this.list[this.getIndex(t)]},take(...t){let e=[];for(const i of t)e=e.concat(this.takeFrom(i));return e},takeMark(t){return this.take(...this.marks[t])},count(t){return this.take(t).length},countAll(){let t=0;for(let e=this.list.length-1;e>=0;--e)t+=this.list[e].length;return t},clear(t){this.list[this.getIndex(t)].length=0},clearAll(){for(let t=this.list.length-1;t>=0;--t)this.list[t].length=0;this.ID=0},clearAllExcept(t){for(let e=this.list.length-1;e>=0;--e)for(let i=this.list[e].length-1;i>=0;--i)t(this.list[e][i])||this.list[e].splice(i,1)},onSceneRestart(){NZ.OBJ._persistentDisabled?NZ.OBJ.clearAll():NZ.OBJ.clearAllExcept(t=>t.nzPersistent)},push(t,e){const i=this.getIndex(t);if(i<0)throw new Error(`Name not exists: '${t}'. Try insert "OBJ.add('${t}');" to your code.`);return e.id=this.ID++,this.list[i].push(e),e.start(),e},create(t,...e){if(this.getIndex(t)<0)throw new Error(`Name not exists: '${t}'. Try insert "OBJ.add('${t}');" to your code.`);const i=this.linkedClass[t];if("function"!=typeof i)throw new Error(`Class not found: '${t}'. Try insert "OBJ.link('${t}', [the name of the class]);" to your code.`);const s=new i(...e);return this.push(t,s)},get(t){for(let e=this.list.length-1;e>=0;--e)for(let i=this.list[e].length-1;i>=0;--i)if(this.list[e][i].id===t)return this.list[e][i]},remove(t){for(let e=this.list.length-1;e>=0;--e)for(let i=this.list[e].length-1;i>=0;--i)if(this.list[e][i].id===t)return this.list[e].splice(i,1)[0]},getFrom(t,e){let i=this.getIndex(t);for(let t=this.list[i].length-1;t>=0;--t)if(this.list[i][t].id===e)return this.list[i][t]},removeFrom(t,e){let i=this.getIndex(t);for(let t=this.list[i].length-1;t>=0;--t)if(this.list[i][t].id===e)return this.list[i].splice(t,1)[0]},pop(t){let e=this.getIndex(t);return this.list[e].shift()},onAll(t,e){for(const i of this.take(t))e(i)},nearest(t,e,i){let s=null,n=Number.POSITIVE_INFINITY,o=this.getIndex(t);for(let t=this.list[o].length-1;t>=0;--t){const r=this.list[o][t],a=(e-r.x)*(e-r.x)+(i-r.y)*(i-r.y);a<=n&&(s=r,n=a)}return s}},(NZ=NZ||{}).Runner={active:!0},window.requestAnimationFrame=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame,NZ.Runner.start=(()=>{NZ.Runner.active=!0,window.requestAnimationFrame(NZ.Runner.run)}),NZ.Runner.stop=(()=>{NZ.Runner.active=!1,window.cancelAnimationFrame(NZ.Runner.run)}),NZ.Runner.run=(t=>{NZ.Runner.active&&(NZ.Draw.autoReset&&NZ.Draw.reset(),NZ.UI.autoReset&&(NZ.UI.reset(),NZ.UI.applyCursor(NZ.Stage.canvas)),NZ.Time.update(t),NZ.Sound.update(),NZ.Input.keyDown(NZ.Debug.modeKeyCode)&&++NZ.Debug.mode>=NZ.Debug.modeAmount&&(NZ.Debug.mode=0),NZ.Scene.update(),NZ.OBJ.update(),NZ.Stage.autoClear&&NZ.Stage.clear(),NZ.Scene.render(),NZ.OBJ.render(),NZ.Scene.renderUI(),NZ.Input.reset(),window.requestAnimationFrame(NZ.Runner.run))});class NZScene{constructor(t){this.name=t}start(){}update(){}render(){}renderUI(){}}(NZ=NZ||{}).Scene={list:{},listener:{},current:new NZScene,previous:new NZScene,get name(){return this.current.name},add(t,e){if("number"==typeof t&&(t+=""),"string"!=typeof t)throw new TypeError("The provided 'name' cannot be converted to string.");return this.list[t]=e,this.list[t]},create(t){return this.add(t,new NZScene(t))},on(t,e){this.listener[t]||(this.listener[t]=[]),this.listener[t].push(e)},onRestart(){for(let t=this.listener.restart.length-1;t>=0;--t)this.listener.restart[t]()},restart(){this.onRestart(),this.current.start&&this.current.start()},start(t){const e=this.list[t];if(!(e instanceof NZScene))throw new Error(`Scene not found: '${t}'`);e!==this.current&&(this.previous=this.current),this.current=e,this.restart()},update(){this.current.update&&this.current.update()},render(){this.current.render&&this.current.render()},renderUI(){this.current.renderUI&&this.current.renderUI()}},(NZ=NZ||{}).Sound={list:[],names:[],supportedExt:["ogg","mp3","wav"],getIndex(t){return"number"==typeof t?t:this.names.indexOf(t)},add(t,e){return e.loopFrom=0,e.loopTo=1,this.list.push(e),this.names.push(t),this.list[this.getIndex(t)]},exists(t){return void 0!==this.list[this.getIndex(t)]},get(t){if(t instanceof Audio)return t;if(!this.exists(t))throw new Error(`Sound not found: ${t}`);return this.list[this.getIndex(t)]},play(t){const e=this.get(t);e&&(e.currentTime=0,e.play())},loop(t){const e=this.get(t);e&&(e.loop=!0,e.currentTime=0,e.play())},stop(t){const e=this.get(t);e&&(e.pause(),e.currentTime=0,e.loop=!1)},pause(t){const e=this.get(t);e&&e.pause()},resume(t){const e=this.get(t);e&&e.play()},isPlaying(t){const e=this.get(t);return!!e&&(e.currentTime>0&&!e.paused)},playAtOnce(t){this.isPlaying(t)||this.play(t)},setVolume(t,e){const i=this.get(t);i&&(i.volume=Math.min(1,Math.max(0,e)))},getVolume(t){const e=this.get(t);return e?e.volume:0},setLoopRange(t,e,i){const s=this.get(t);s&&(s.loopFrom=e,s.loopTo=i)},update(){for(let t=this.list.length-1;t>=0;--t){const e=this.list[t];e.loop&&e.currentTime>=e.duration*e.loopTo&&(e.currentTime=e.duration*e.loopFrom)}}},(NZ=NZ||{}).Stage={LOW:.5,HIGH:2,ULTRA:4,NORMAL:1,pixelRatio:1,canvas:null,autoClear:!0,redrawOnResize:!0,w:300,h:150,mid:{w:150,h:75},size:{x:300,y:150,mid:{x:150,y:75}},listeners:{resize:[]},on(t,e){return this.listeners[t].push(e),e},off(t,e){const i=this.listeners[t];for(let t=i.length-1;t>=0;--t)if(i[t]===e)return i.splice(t,1)[0]},trigger(t){for(let e=this.listeners[t].length-1;e>=0;--e)this.listeners[t][e]()},get randomX(){return Math.random()*this.size.x},get randomY(){return Math.random()*this.size.y},get randomSize(){return{x:Math.random()*this.size.x,y:Math.random()*this.size.y}},get pixelRatioText(){const t=this.pixelRatio;let e="Ultra";return t<4&&(e="High"),t<2&&(e="Normal"),t<1&&(e="Low"),e},setupCanvas(t){return this.canvas=t,this.canvas.ctx=this.canvas.getContext("2d"),t},setPixelRatio(t){this.pixelRatio=t},resetPixelRatio(){this.pixelRatio=1},applyPixelRatio(){const t=document.createElement("canvas");this.redrawOnResize&&this.canvas.width>0&&this.canvas.height>0&&(t.width=this.canvas.width,t.height=this.canvas.height,t.getContext("2d").drawImage(this.canvas,0,0)),this.canvas.width=this.w*this.pixelRatio,this.canvas.height=this.h*this.pixelRatio,this.canvas.ctx.resetTransform(),this.canvas.ctx.drawImage(t,0,0),this.canvas.ctx.scale(this.pixelRatio,this.pixelRatio)},clear(){this.canvas.ctx.clearRect(0,0,this.w,this.h)},resize(t,e){this.w=t,this.h=e,this.mid.w=.5*this.w,this.mid.h=.5*this.h,this.size.x=t,this.size.y=e,this.size.mid.x=.5*this.size.x,this.size.mid.y=.5*this.size.y,this.trigger("resize")},resizeEvent(){const t=NZ.Stage.canvas.getBoundingClientRect();NZ.Stage.resize(t.width,t.height),NZ.Stage.applyPixelRatio()},setupEvent(){window.addEventListener("resize",this.resizeEvent)},setBGColor(t){let e=["white","mintcream"];t&&(t instanceof Array?(e[0]=t[0],e[1]=t[1]):(e[0]=t,e[1]=t)),this.canvas.style.backgroundImage=`radial-gradient(${e[0]} 33%, ${e[1]})`},resetBGColor(){this.setBGColor()}},(NZ=NZ||{}).StylePreset={none:"",noGap:"* { margin: 0; padding: 0; }"},NZ.StylePreset.middle=(t=>`#${t} { position: absolute; top: 50%; transform: translateY(-50%); }`),NZ.StylePreset.center=(t=>`#${t} { position: absolute; left: 50%; transform: translateX(-50%); }`),NZ.StylePreset.middleCenter=(t=>`#${t} { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }`),NZ.StylePreset.noGapMiddle=(t=>NZ.StylePreset.noGap+NZ.StylePreset.middle(t)),NZ.StylePreset.noGapCenter=(t=>NZ.StylePreset.noGap+NZ.StylePreset.center(t)),NZ.StylePreset.noGapMiddleCenter=(t=>NZ.StylePreset.noGap+NZ.StylePreset.middleCenter(t)),NZ.StylePreset.centerMiddle=NZ.StylePreset.middleCenter,NZ.StylePreset.noGapCenterMiddle=NZ.StylePreset.noGapMiddleCenter,NZ.StylePreset.fullViewport=((t,e)=>`\n\t* {\n\t\tmargin: 0;\n\t\tpadding: 0;\n\t}\n\t${e} {\n\t\twidth: 100vw;\n\t\theight: 100vh;\n\t\tposition: absolute;\n\t\toverflow: hidden;\n\t}\n\t#${t} {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n`),(NZ=NZ||{}).Time={FPS:60,time:0,lastTime:0,deltaTime:0,scaledDeltaTime:0,fixedDeltaTime:1e3/60,inversedFixedDeltaTime:.06,_fpsCount:0,frameRate:0,frameCount:0,update(t){this.lastTime=this.time,this.time=t||0,this.deltaTime=this.time-this.lastTime,this.frameRate=this.fixedDeltaTime/this.deltaTime,this.scaledDeltaTime=this.deltaTime*this.inversedFixedDeltaTime,this.frameCount>this._fpsCount&&(this.FPS=Math.floor(60*this.frameRate),this._fpsCount=this.frameCount+6),this.frameCount++},sin(t=1,e=.01){return Math.sin(this.time*e)*t},cos(t=1,e=.01){return Math.cos(this.time*e)*t},toSeconds:t=>Math.floor(.001*t),toMinutes:t=>Math.floor(t/6e4),toClockSeconds:t=>Math.abs(Math.floor(.001*t)%60),toClockMinutes:t=>Math.abs(Math.floor(t/6e4)%60),toClockSecondsWithLeadingZero(t){const e=this.toClockSeconds(t);return`${e<10?"0":""}${e}`},toClockMinutesWithLeadingZero(t){const e=this.toClockMinutes(t);return`${e<10?"0":""}${e}`},toClock(t){return`${this.toClockMinutes(t)}:${this.toClockSeconds(t)}`},toClockWithLeadingZero(t){return`${this.toClockMinutesWithLeadingZero(t)}:${this.toClockSecondsWithLeadingZero(t)}`},toStopwatch:t=>`${Math.abs(Math.floor(t/6e4)%60).toString().padStart(2).replace(/\s/,"0")}:${Math.abs(Math.floor(.001*t)%60).toString().padStart(2).replace(/\s/,"0")}.${(.001*t).toFixed(2).padStart(10).substr(8)}`,get s(){return this.toSeconds(this.time)},get m(){return this.toMinutes(this.time)},get ss(){return this.toClockSecondsWithLeadingZero(this.time)},get mm(){return this.toClockMinutesWithLeadingZero(this.time)}},(NZ=NZ||{}).Transform=function(t=Vec3.zero,e=Vec3.zero,i=Vec3.one){this.position=t,this.rotation=e,this.rotationMode=NZ.Transform.YXZ,this.scale=i},NZ.Transform.XYZ="XYZ",NZ.Transform.XZY="XZY",NZ.Transform.YXZ="YXZ",NZ.Transform.YZX="YZX",NZ.Transform.ZXY="ZXY",NZ.Transform.ZYX="ZYX",NZ.Transform.prototype.reset=function(){this.position.set(0),this.rotation.set(0),this.scale.set(1)},NZ.Transform.prototype.clone=function(){return new NZ.Transform(this.position.clone(),this.rotation.clone(),this.scale.clone())},(NZ=NZ||{}).Tri=function(t,e=C.white){this.p=t,this.depth=0,this.baseColor=e,this.bakedColor=this.baseColor,this.lightDotProduct=0,this.ref=null},NZ.Tri.prototype.clone=function(){const t=new NZ.Tri([this.p[0].clone(),this.p[1].clone(),this.p[2].clone()]);return t.depth=this.depth,t.baseColor=this.baseColor,t.bakedColor=this.bakedColor,t.lightDotProduct=this.lightDotProduct,t.ref=this.ref,t},NZ.Tri.prototype.onAllPoints=function(t){for(let e=0;e<3;e++)t(this.p[e])},NZ.Tri.prototype.calculateDepth=function(){this.depth=(this.p[0].z+this.p[1].z+this.p[2].z)/3},(NZ=NZ||{}).UI={autoReset:!0,cursor:"default",setCursor(t){this.cursor=t},resetCursor(){this.setCursor("default")},applyCursor(t,e){e=e||this.cursor,t.style.cursor=this.cursor=e},reset(){this.resetCursor()}},(NZ=NZ||{}).Utils={pick:t=>t[Math.floor(Math.random()*t.length)],picko(t){return this.pick(Object.values(t))},randpop:t=>t.splice(Math.floor(Math.random()*t.length),1)[0],repeat(t,e){let i=0;for(;t-- >0;)e(i++)},copyToClipboard(t){const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},(NZ=NZ||{}).Vec2=function(t,e){this.x=t||0,this.y=e||0},NZ.Vec2.EPSILON=1e-6,NZ.Vec2.degtorad=function(t){return.017453292519943295*t},NZ.Vec2.radtodeg=function(t){return 57.29577951308232*t},NZ.Vec2.range=function(t,e,i=Math.random()){return t+i*(e-t)},NZ.Vec2.clamp=function(t,e,i){return Math.min(i,Math.max(e,t))},NZ.Vec2._checkArg=function(t){let e;if(t instanceof NZ.Vec2)e=t.clone();else{if("object"!=typeof t)throw new TypeError("The provided value cannot be converted to NZ.Vec2.");e=NZ.Vec2.fromObject(t)}return e},NZ.Vec2._checkArgs=function(t,e,i=!1){if(arguments.length<1)throw new Error("At least 1 argument required, but nothing present.");if(t instanceof NZ.Vec2||"object"==typeof t)e=t.y,t=t.x;else if("number"!=typeof t)throw new TypeError("The provided value cannot be converted to NZ.Vec2 or number.");return void 0===e&&(e=t),i?[t,e]:{x:t,y:e}},NZ.Vec2.prototype.set=function(t,e){return e=(t=NZ.Vec2._checkArgs(t,e)).y,t=t.x,this.x=t,this.y=e,this},NZ.Vec2.prototype.add=function(t,e){return e=(t=NZ.Vec2._checkArgs(t,e)).y,t=t.x,this.x+=t,this.y+=e,this},NZ.Vec2.prototype.sub=function(t,e){return e=(t=NZ.Vec2._checkArgs(t,e)).y,t=t.x,this.x-=t,this.y-=e,this},NZ.Vec2.prototype.mul=function(t,e){return e=(t=NZ.Vec2._checkArgs(t,e)).y,t=t.x,this.x*=t,this.y*=e,this},NZ.Vec2.prototype.mult=function(t,e){return this.mul(t,e)},NZ.Vec2.prototype.div=function(t,e){return e=(t=NZ.Vec2._checkArgs(t,e)).y,t=t.x,this.x/=t,this.y/=e,this},NZ.Vec2.prototype.lerp=function(t,e){return new NZ.Vec2(NZ.Vec2.range(this.x,t.x,e),NZ.Vec2.range(this.y,t.y,e))},NZ.Vec2.prototype.reset=function(){this.set(0)},NZ.Vec2.prototype.clone=function(){return new NZ.Vec2(this.x,this.y)},NZ.Vec2.prototype.angle=function(){return NZ.Vec2.direction(NZ.Vec2.zero,this)},NZ.Vec2.prototype.polar=function(){return NZ.Vec2.polar(this.angle())},NZ.Vec2.prototype.toString=function(t=-1){return t>-1?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)})`:`(${this.x}, ${this.y})`},NZ.Vec2.prototype.setMag=function(t){return this.length=t,this},NZ.Vec2.prototype.getMag=function(){return this.length},NZ.Vec2.prototype.normalize=function(){const t=this.length;return 0!==t&&this.div(t),this},NZ.Vec2.prototype.distance=function(t){return Math.hypot(t.x-this.x,t.y-this.y)},NZ.Vec2.prototype.direction=function(t){let e=NZ.Vec2.radtodeg(Math.atan2(t.y-this.y,t.x-this.x));return e<0?e+360:e},NZ.Vec2.prototype.equal=function(t){return this.x===t.x&&this.y===t.y},NZ.Vec2.prototype.fuzzyEqual=function(t,e=NZ.Vec2.EPSILON){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e},NZ.Vec2.prototype.ceil=function(t=1){return this.x=Math.ceil(this.x*t)/t,this.y=Math.ceil(this.y*t)/t,this},NZ.Vec2.prototype.floor=function(t=1){return this.x=Math.floor(this.x*t)/t,this.y=Math.floor(this.y*t)/t,this},NZ.Vec2.prototype.round=function(t=1){return this.x=Math.round(this.x*t)/t,this.y=Math.round(this.y*t)/t,this},NZ.Vec2.prototype.limit=function(t){return this.length>t&&(this.length=t),this},NZ.Vec2.prototype.clamp=function(t,e,i,s){return void 0===i&&(i=t),void 0===s&&(s=e),this.x=NZ.Vec2.clamp(this.x,t,e),this.y=NZ.Vec2.clamp(this.y,i,s),this},NZ.Vec2.prototype.manhattanDistance=function(t){return Math.abs(t.x-this.x)+Math.abs(t.y-this.y)},NZ.Vec2.fromObject=function(t){if(void 0===t.x)throw new TypeError("The provided object has no 'x' component defined.");if(void 0===t.y)throw new TypeError("The provided object has no 'y' component defined.");return new NZ.Vec2(t.x,t.y)},NZ.Vec2.add=function(t,e){const i=NZ.Vec2._checkArg(t);return i.add(e),i},NZ.Vec2.sub=function(t,e){const i=NZ.Vec2._checkArg(t);return i.sub(e),i},NZ.Vec2.mul=function(t,e){const i=NZ.Vec2._checkArg(t);return i.mul(e),i},NZ.Vec2.mult=function(t,e){return NZ.Vec2.mul(t,e)},NZ.Vec2.div=function(t,e){const i=NZ.Vec2._checkArg(t);return i.div(e),i},NZ.Vec2.reset=function(t){t.x=0,t.y=0},NZ.Vec2.clone=function(t){return new NZ.Vec2(t.x,t.y)},NZ.Vec2.distance=function(t,e){return NZ.Vec2._checkArg(t).distance(e)},NZ.Vec2.direction=function(t,e){return NZ.Vec2._checkArg(t).direction(e)},NZ.Vec2.equal=function(t,e){return NZ.Vec2._checkArg(t).equal(e)},NZ.Vec2.fuzzyEqual=function(t,e,i=NZ.Vec2.EPSILON){return NZ.Vec2._checkArg(t).fuzzyEqual(e)},NZ.Vec2.manhattanDistance=function(t,e){return NZ.Vec2._checkArg(t).manhattanDistance(e)},NZ.Vec2.random=function(t,e,i,s){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=t),void 0===s&&(s=e),new NZ.Vec2(NZ.Vec2.range(t,e),NZ.Vec2.range(i,s))},NZ.Vec2.random2D=function(){return Vec2.polar(360*Math.random())},NZ.Vec2.create=function(t,e){return void 0===e&&(e=t),new NZ.Vec2(t,e)},NZ.Vec2.polar=function(t,e=1){return t=NZ.Vec2.degtorad(t),new NZ.Vec2(Math.cos(t)*e,Math.sin(t)*e)},Object.defineProperty(NZ.Vec2.prototype,"xy",{get:function(){return this.x+this.y}}),Object.defineProperty(NZ.Vec2.prototype,"abs",{get:function(){return new NZ.Vec2(Math.abs(this.x),Math.abs(this.y))}}),Object.defineProperty(NZ.Vec2.prototype,"mid",{get:function(){return new NZ.Vec2(.5*this.x,.5*this.y)}}),Object.defineProperty(NZ.Vec2.prototype,"sign",{get:function(){return new NZ.Vec2(Math.sign(this.x),Math.sign(this.y))}}),Object.defineProperty(NZ.Vec2.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set:function(t){const e=this.length;0!==e&&this.mul(t/e)}}),Object.defineProperty(NZ.Vec2,"up",{get:function(){return new NZ.Vec2(0,-1)}}),Object.defineProperty(NZ.Vec2,"left",{get:function(){return new NZ.Vec2(-1,0)}}),Object.defineProperty(NZ.Vec2,"down",{get:function(){return new NZ.Vec2(0,1)}}),Object.defineProperty(NZ.Vec2,"right",{get:function(){return new NZ.Vec2(1,0)}}),Object.defineProperty(NZ.Vec2,"one",{get:function(){return new NZ.Vec2(1,1)}}),Object.defineProperty(NZ.Vec2,"zero",{get:function(){return new NZ.Vec2(0,0)}}),Object.defineProperty(NZ.Vec2,"center",{get:function(){return new NZ.Vec2(.5,.5)}}),(NZ=NZ||{}).Vec3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0,this.w=1},NZ.Vec3.EPSILON=1e-6,NZ.Vec3._checkArg=function(t){let e;if(t instanceof NZ.Vec3)e=t.clone();else{if("object"!=typeof t)throw new TypeError("The provided value cannot be converted to NZ.Vec3.");e=NZ.Vec3.fromObject(t)}return e},NZ.Vec3._checkArgs=function(t,e,i){if(arguments.length<1)throw new Error("At least 1 argument required, but nothing present.");if(t instanceof NZ.Vec3||"object"==typeof t)i=t.z,e=t.y,t=t.x;else if("number"!=typeof t)throw new TypeError("The provided value cannot be converted to NZ.Vec3 or number.");return void 0===e&&(e=t),void 0===i&&(i=t),{x:t,y:e,z:i}},NZ.Vec3.prototype.set=function(t,e,i){return i=(t=NZ.Vec3._checkArgs(t,e,i)).z,e=t.y,t=t.x,this.x=t,this.y=e,this.z=i,this},NZ.Vec3.prototype.add=function(t,e,i){return i=(t=NZ.Vec3._checkArgs(t,e,i)).z,e=t.y,t=t.x,this.x+=t,this.y+=e,this.z+=i,this},NZ.Vec3.prototype.sub=function(t,e,i){return i=(t=NZ.Vec3._checkArgs(t,e,i)).z,e=t.y,t=t.x,this.x-=t,this.y-=e,this.z-=i,this},NZ.Vec3.prototype.mul=function(t,e,i){return i=(t=NZ.Vec3._checkArgs(t,e,i)).z,e=t.y,t=t.x,this.x*=t,this.y*=e,this.z*=i,this},NZ.Vec3.prototype.mult=function(t,e,i){return this.mul(t,e,i)},NZ.Vec3.prototype.div=function(t,e,i){return i=(t=NZ.Vec3._checkArgs(t,e,i)).z,e=t.y,t=t.x,this.x/=t,this.y/=e,this.z/=i,this},NZ.Vec3.prototype.reset=function(){this.set(0)},NZ.Vec3.prototype.clone=function(){return new NZ.Vec3(this.x,this.y,this.z)},NZ.Vec3.prototype.toString=function(t=-1){return t>-1?`(${this.x.toFixed(t)}, ${this.y.toFixed(t)}, ${this.z.toFixed(t)})`:`(${this.x}, ${this.y}, ${this.z})`},NZ.Vec3.prototype.normalize=function(){const t=this.length;0!==t&&this.div(t)},NZ.Vec3.prototype.distance=function(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)+(t.z-this.z)*(t.z-this.z))},NZ.Vec3.prototype.equal=function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},NZ.Vec3.prototype.fuzzyEqual=function(t,e=NZ.Vec3.EPSILON){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e&&Math.abs(this.z-t.z)<=e},NZ.Vec3.prototype.limit=function(t){return this.length>t&&(this.length=t),this},NZ.Vec3.fromObject=function(t){return new NZ.Vec3(t.x,t.y,t.z)},NZ.Vec3.add=function(t,e){const i=NZ.Vec3._checkArg(t);return i.add(e),i},NZ.Vec3.sub=function(t,e){const i=NZ.Vec3._checkArg(t);return i.sub(e),i},NZ.Vec3.mul=function(t,e){const i=NZ.Vec3._checkArg(t);return i.mul(e),i},NZ.Vec3.mult=function(t,e){return NZ.Vec3.mul(t,e)},NZ.Vec3.div=function(t,e){const i=NZ.Vec3._checkArg(t);return i.div(e),i},NZ.Vec3.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},NZ.Vec3.cross=function(t,e){return new NZ.Vec3(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},NZ.Vec3.reset=function(t){t.x=0,t.y=0,t.z=0},NZ.Vec3.clone=function(t){return new NZ.Vec3(t.x,t.y,t.z)},NZ.Vec3.distance=function(t,e){return NZ.Vec3._checkArg(t).distance(e)},NZ.Vec3.create=function(t,e,i){return void 0===e&&(e=t),void 0===i&&(i=t),new NZ.Vec3(t,e,i)},Object.defineProperty(NZ.Vec3.prototype,"abs",{get:function(){return new NZ.Vec3(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))}}),Object.defineProperty(NZ.Vec3.prototype,"mid",{get:function(){return new NZ.Vec3(.5*this.x,.5*this.y,.5*this.z)}}),Object.defineProperty(NZ.Vec3.prototype,"sign",{get:function(){return new NZ.Vec3(Math.sign(this.x),Math.sign(this.y),Math.sign(this.z))}}),Object.defineProperty(NZ.Vec3.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set:function(t){const e=this.length;0!==e&&this.mul(t/e)}}),Object.defineProperty(NZ.Vec3,"up",{get:function(){return new NZ.Vec3(0,1,0)}}),Object.defineProperty(NZ.Vec3,"left",{get:function(){return new NZ.Vec3(-1,0,0)}}),Object.defineProperty(NZ.Vec3,"down",{get:function(){return new NZ.Vec3(0,-1,0)}}),Object.defineProperty(NZ.Vec3,"right",{get:function(){return new NZ.Vec3(1,0,0)}}),Object.defineProperty(NZ.Vec3,"forward",{get:function(){return new NZ.Vec3(0,0,1)}}),Object.defineProperty(NZ.Vec3,"backward",{get:function(){return new NZ.Vec3(0,0,-1)}}),Object.defineProperty(NZ.Vec3,"one",{get:function(){return new NZ.Vec3(1,1,1)}}),Object.defineProperty(NZ.Vec3,"zero",{get:function(){return new NZ.Vec3(0,0,0)}});class NZGameObject extends NZObject{static makeRect(t,e,i,s,n,o,r){const a=new NZGameObject(t,e,n,o,r);return a.width=i,a.height=s,a}static makeCircle(t,e,i,s,n,o){const r=new NZGameObject(t,e,s,n,o);return r.radius=i,r}constructor(t,e,i,s,n){super(),this.alarm=[-1,-1,-1,-1,-1,-1],this.position=new NZ.Vec2(t,e),this.velocity=NZ.Vec2.polar(s||0,i||0),this.acceleration=new NZ.Vec2(0,0),this.mass=1,this.width=32,this.height=32,this.radius=16,this.bounce=-.9,this.friction=.999,this.gravity=0===n?0:n||.5,this.constraint=!0}get speed(){return this.velocity.length}set speed(t){this.velocity.length=t}accelerate(t){this.velocity.add(t)}applyForce(t){this.acceleration.add(t)}physicsUpdate(){this.velocity.add(this.acceleration),this.velocity.mult(this.friction),this.velocity.add(0,this.gravity),this.position.add(this.velocity),this.acceleration.mult(0),this.constraint&&this.constraintOnTheStage()}constraintOnTheStage(){let t=.5*this.width,e=.5*this.height;this.position.x+t>NZ.Stage.w?(this.position.x=NZ.Stage.w-t,this.velocity.x*=this.bounce):this.position.x-t<0&&(this.position.x=t,this.velocity.x*=this.bounce),this.position.y+e>NZ.Stage.h?(this.position.y=NZ.Stage.h-e,this.velocity.y*=this.bounce):this.position.y-e<0&&(this.position.y=e,this.velocity.y*=this.bounce)}angleTo(t){return NZ.Vec2.direction(this.position,t.position)}distanceTo(t){return NZ.Vec2.distance(this.position,t.position)}gravitateTo(t){const e=this.distanceTo(t),i=NZ.Vec2.polar(this.angleTo(t),t.mass/(e*e));this.applyForce(i)}alarm0(){}alarm1(){}alarm2(){}alarm3(){}alarm4(){}alarm5(){}alarmUpdate(){for(let t=this.alarm.length-1;t>=0;--t)if(-1!==this.alarm[t]&&(this.alarm[t]-=1,this.alarm[t]<0)){switch(t){case 0:this.alarm0();break;case 1:this.alarm1();break;case 2:this.alarm2();break;case 3:this.alarm3();break;case 4:this.alarm4();break;case 5:this.alarm5()}this.alarm[t]<0&&(this.alarm[t]=-1)}}drawRect(t){NZ.Draw.rect(this.position.x-.5*this.width,this.position.y-.5*this.height,this.width,this.height,t)}drawCircle(t){NZ.Draw.circle(this.position.x,this.position.y,this.radius,t)}postUpdate(){this.physicsUpdate(),this.alarmUpdate()}}class NZObject3D extends NZObject{constructor(t,e=NZ.Vec3.zero,i=NZ.Vec3.zero){super(),this.mesh=t,this.transform=null,e instanceof NZ.Transform?this.transform=e.clone():this.transform=new NZ.Transform(e,i)}processTrisToRaster(t,e){const i=NZ.Mat4.makeTransformation(this.transform);for(let s=this.mesh.tris.length-1;s>=0;--s){const n=this.mesh.tris[s].clone();if(n.p[0]=NZ.Mat4.mulVec3(i,n.p[0]),n.p[1]=NZ.Mat4.mulVec3(i,n.p[1]),n.p[2]=NZ.Mat4.mulVec3(i,n.p[2]),n.p[0].z<=0&&n.p[1].z<=0&&n.p[2].z<=0)continue;const o=NZ.Vec3.sub(n.p[1],n.p[0]),r=NZ.Vec3.sub(n.p[2],n.p[0]),a=NZ.Vec3.cross(o,r);a.normalize();const h=NZ.Vec3.sub(n.p[0],NZ.Vec3.zero);if(NZ.Vec3.dot(a,h)<0){const i=new NZ.Vec3(0,0,-1);i.normalize(),n.lightDotProduct=NZ.Vec3.dot(a,i),n.bakedColor=NZ.C.multiply(n.baseColor,.2+Mathz.clamp(.8*n.lightDotProduct,0,1)),n.p[0]=NZ.Mat4.mulVec3(t,n.p[0]),n.p[1]=NZ.Mat4.mulVec3(t,n.p[1]),n.p[2]=NZ.Mat4.mulVec3(t,n.p[2]),n.onAllPoints(t=>{t.div(t.w),t.add(1,1,0),t.mul(Stage.mid.w,-Stage.mid.h,1),t.y+=Stage.h}),n.calculateDepth(),e.push(n)}}}}var NZ=NZ||{};const{C:C,UI:UI,Net:Net,OBJ:OBJ,Tri:Tri,Draw:Draw,Font:Font,Mat4:Mat4,Mesh:Mesh,Time:Time,Vec2:Vec2,Vec3:Vec3,Align:Align,Debug:Debug,Input:Input,Mathz:Mathz,Scene:Scene,Sound:Sound,Stage:Stage,Utils:Utils,Cursor:Cursor,Loader:Loader,BGColor:BGColor,KeyCode:KeyCode,LineCap:LineCap,LineDash:LineDash,LineJoin:LineJoin,BoundRect:BoundRect,Primitive:Primitive,Transform:Transform,StylePreset:StylePreset}=NZ;